---
import proposalPic from "../../public/proposal.jpg";
import TimelineCard from "./TimelineCard.vue";
import WhenAndWhere from "./WhenAndWhere.vue";
import RSVPCard from "./RSVPCard.astro";
import Map from "./Map.astro";
import TravelAndAccomodationCard from "./TravelAndAccomodationCard.astro";
import { amalfiNight, randomShit, reception, wedding } from "../eventInfo";
import { Image } from "astro:assets";
import diyaBackground from "../assets/diya_background.jpeg";
---

<div class="flex h-full flex-col">
  <div class="relative mb-1 md:bg-[#e5e4d2]">
    <Image
      src={diyaBackground}
      alt="Diya Background"
      class="invisible absolute top-0 left-0 z-0 h-full w-auto object-cover object-left opacity-25 md:visible"
      layout="constrained"
    />

    <div
      class="font-dancing-script text-title-green relative z-10 flex items-center justify-center text-[40px] md:py-2.5 md:text-6xl"
    >
      Nainesh & Nikita
    </div>

    <div
      class="font-domine relative z-10 my-2 flex flex-row items-center justify-center gap-4 text-center text-sm text-gray-400 italic md:text-base"
      id="links-original"
    >
      <a href="#timeline">Timeline</a>
      <div class="hidden h-4 w-0.25 bg-gray-400 md:block"></div>
      <a href="#rsvp">RSVP</a>
      <div class="hidden h-4 w-0.25 bg-gray-400 md:block"></div>
      <a href="#travel-and-accommodation">Travel and Accomodation</a>
      <div class="hidden h-4 w-0.25 bg-gray-400 md:block"></div>
      <a href="#map">Map</a>
    </div>

    <img
      src={proposalPic.src}
      alt="Proposal Picture"
      class="relative z-10 m-auto h-36 w-full md:h-96 md:w-3/4"
    />
    <div class="relative z-10">
      <WhenAndWhere client:load />
    </div>

    <Image
      src={diyaBackground}
      alt="Diya Background"
      class="invisible absolute top-0 right-0 z-0 h-full w-auto scale-x-[-1] object-cover object-left opacity-25 md:visible"
      layout="constrained"
    />
  </div>

  <!-- Fixed navigation (hidden initially, shows when original scrolls out) -->
  <div
    id="links-fixed"
    class="font-domine pointer-events-none fixed top-0 right-0 left-0 z-50 flex flex-row items-center justify-center gap-4 bg-white/70 py-2 text-center text-sm text-gray-400 italic opacity-0 backdrop-blur-sm transition-opacity duration-300 md:text-base"
  >
    <a href="#timeline">Timeline</a>
    <div class="hidden h-4 w-0.25 bg-gray-400 md:block"></div>
    <a href="#rsvp">RSVP</a>
    <div class="hidden h-4 w-0.25 bg-gray-400 md:block"></div>
    <a href="#travel-and-accommodation">Travel and Accomodation</a>
    <div class="hidden h-4 w-0.25 bg-gray-400 md:block"></div>
    <a href="#map">Map</a>
  </div>

  <script>
    const originalLinks = document.getElementById("links-original");
    const fixedLinks = document.getElementById("links-fixed");

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            // Original links are visible, hide fixed version
            fixedLinks?.classList.add("opacity-0", "pointer-events-none");
          } else {
            // Original links are not visible, show fixed version
            fixedLinks?.classList.remove("opacity-0", "pointer-events-none");
          }
        });
      },
      {
        threshold: 0,
      },
    );

    observer.observe(originalLinks!);
  </script>

  <div class="w-full bg-linear-to-br from-[#FFFFFF] to-[#e5e4d2]">
    <div class="flex w-full flex-col gap-1">
      <!-- <div class="mb-6"></div> -->
      <div
        class="xs:mx-32 mx-28 flex h-8 flex-row justify-center bg-[url('/src/assets/dandiya-ladies.svg')] bg-center bg-repeat-space md:mx-96 md:h-12"
      >
      </div>
      <div
        id="timeline"
        class="flex w-full scroll-mt-14 flex-col gap-1 md:m-auto md:grid md:w-9/10 md:grid-cols-2 md:gap-6"
      >
        <TimelineCard
          event={amalfiNight}
          bgColor="yellow"
          backgroundImage="elephants"
          backgroundPosition="bottom"
          client:load
        />

        <TimelineCard
          event={randomShit}
          bgColor="green"
          backgroundImage="peacock"
          backgroundPosition="right"
          client:load
        />

        <TimelineCard
          event={wedding}
          bgColor="yellow"
          backgroundImage="elephants"
          backgroundPosition="bottom"
          client:load
        />

        <TimelineCard
          event={reception}
          bgColor="green"
          backgroundImage="birds-of-paradise"
          backgroundPosition="left"
          client:load
        />
      </div>
      <div
        class="xs:mx-32 mx-28 flex h-8 flex-row justify-center bg-[url('/src/assets/dandiya-ladies.svg')] bg-center bg-repeat-space md:mx-96 md:h-12"
      >
      </div>

      <RSVPCard />

      <div
        class="xs:mx-32 mx-28 flex h-8 flex-row justify-center bg-[url('/src/assets/dandiya-ladies.svg')] bg-center bg-repeat-space md:mx-96 md:h-12"
      >
      </div>

      <TravelAndAccomodationCard id="travel-and-accommodation" />

      <div
        class="xs:mx-32 mx-28 flex h-8 flex-row justify-center bg-[url('/src/assets/dandiya-ladies.svg')] bg-center bg-repeat-space md:mx-96 md:h-12"
      >
      </div>

      <Map id="map" />
    </div>
  </div>
</div>
